---
title: æœ€çŸ­è·¯
categories: ç®—æ³•æ•™ç¨‹
slug: f216fabe
date: 2023-01-11 16:01:52
cover: 'https://picbed-1304952903.cos.ap-beijing.myqcloud.com/pic/blog202302091658477.png'
---
# æœ€çŸ­è·¯
## å¸¸è§æœ€çŸ­è·¯é—®é¢˜ä¸ç®—æ³•
![](https://picbed-1304952903.cos.ap-beijing.myqcloud.com/pic/blog202301111623030.png)

## æœ´ç´ Dijkstra
1. é€‰æ‹©èµ·ç‚¹ï¼Œèµ·ç‚¹è·ç¦»åˆå§‹åŒ–ä¸º0ï¼Œå…¶ä½™å„ç‚¹è·ç¦»åˆå§‹åŒ–ä¸ºæ— ç©·
1. æ¯æ¬¡ä»æœªæ ‡è®°çš„èŠ‚ç‚¹ä¸­é€‰æ‹©è·ç¦»æœ€å°çš„èŠ‚ç‚¹(å‡è®¾ä¸ºA)ï¼Œæ ‡è®°å¹¶æ”¶å½•åˆ°æœ€ä¼˜è·¯å¾„é›†åˆä¸­
2. è®¡ç®—èŠ‚ç‚¹Açš„ç›¸é‚»èŠ‚ç‚¹Bçš„è·ç¦»(Aåˆ°Bçš„è·ç¦»+Açš„è·ç¦»)ï¼Œè‹¥å°äºåŸæœ‰è·ç¦»åˆ™æ›´æ–°
3. ä¸æ–­é‡å¤ç›´åˆ°ç›®çš„åœ°è¢«æ ‡è®°

*å¦‚æœè¦è®°å½•æœ€çŸ­è·¯ï¼Œè¿˜éœ€è¦ç»™æ¯ä¸ªèŠ‚ç‚¹å¢åŠ ä¸€ä¸ªå±æ€§(å‰ä¸€ä¸ªç‚¹)ï¼Œå¹¶åœ¨æ¯æ¬¡æ›´æ–°è·ç¦»æ—¶æ›´æ–°*

![](https://picbed-1304952903.cos.ap-beijing.myqcloud.com/pic/blog202301111639764.gif)

{% hideBlock code %}
```cpp
//æœ´ç´ Dijkstra
#include <bits/stdc++.h>
using namespace std;

const int N = 1e3 + 10, inf = 0x3f3f3f3f;

int n, m;
int g[N][N];//é‚»æ¥çŸ©é˜µ,æœ´ç´ ä¸€èˆ¬éƒ½æ˜¯ç¨ å¯†å›¾ä½¿ç”¨
int dis[N];//è·ç¦»
bool vis[N];//æ ‡è®°

int Dijkstra(){
    memset(dis, 0x3f, sizeof dis);
    dis[1] = 0;
    //åˆå§‹åŒ–è·ç¦»
    for(int i = 1; i <= n && !vis[n]; i ++){
        int t = -1;
        for(int j = 1; j <= n ; j ++){
            if(!vis[j] && (dis[t] > dis[j] || t == -1)) t = j;
        }
        vis[t] = true;
        for(int j = 1; j <= n; j ++){
            dis[j] = min(dis[j], dis[t] + g[t][j]);
        }
    }
    if(dis[n] == inf) return -1;
    return dis[n];
}


int main(){
    scanf("%d%d", &n, &m);
    //åˆå§‹åŒ–é‚»æ¥çŸ©é˜µ
    memset(g, 0x3f, sizeof g);
    //å»ºå›¾
    while(m --){
        int a, b, c;
        scanf("%d%d%d", &a, &b, &c);
        g[a][b] = min(g[a][b], c);
    }
    printf("%d\n", Dijkstra());
    return 0;
}
```
{% endhideBlock %}

## å †ä¼˜åŒ–Dijkstra
è§‚å¯Ÿ`Dijkstra`æœ´ç´ ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦
å¯ä»¥å‘ç°å…¶ä¸­`åœ¨æœªæ ‡è®°çš„ç‚¹ä¸­å¯»æ‰¾è·ç¦»æœ€å°çš„ç‚¹`æ­¥éª¤çš„æ—¶é—´å¤æ‚åº¦æ˜¯`O(n * n)`çš„ï¼Œä¹Ÿæ˜¯æœ€æ…¢çš„ï¼Œæ‰€ä»¥ä¼˜åŒ–ä¹Ÿæ˜¯é’ˆå¯¹è¿™ä¸€æ­¥è¿›è¡Œçš„ï¼Œå³ä½¿ç”¨`å †`

å¯ä»¥æ‰‹å†™ä¸€ä¸ª`å †`ï¼Œå¯ä»¥ä¿è¯å †ä¸­æ°¸è¿œåªæœ‰nä¸ªæ•°
ä¹Ÿå¯ä»¥ç”¨`priority_queue`ï¼Œä½†æ˜¯ä¸æ”¯æŒæ›´æ”¹å…ƒç´ ï¼Œæ‰€ä»¥å®é™…ä¸Šä¼šæœ‰å†—ä½™

{% hideBlock code %}

```cpp
#include <bits/stdc++.h>

using namespace std;

typedef pair<int, int> PII;

const int N = 150010;

// ç¨€ç–å›¾ç”¨é‚»æ¥è¡¨æ¥å­˜
int h[N], e[N], ne[N], idx;
int w[N]; // ç”¨æ¥å­˜æƒé‡
int dist[N];
bool st[N]; //æ ‡è®°

int n, m;

void add(int x, int y, int c){
    w[idx] = c, e[idx] = y, ne[idx] = h[x], h[x] = idx++;
}

int dijkstra(){
    memset(dist, 0x3f, sizeof(dist));
    dist[1] = 0;
    priority_queue<PII, vector<PII>, greater<PII>> heap;
    // é¦–å…ˆå°æ ¹å †æ˜¯æ ¹æ®è·ç¦»æ¥æ’çš„ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªå˜é‡è¦æ˜¯è·ç¦»ï¼Œ
    // å…¶æ¬¡åœ¨ä»å †ä¸­æ‹¿å‡ºæ¥çš„æ—¶å€™è¦çŸ¥é“çŸ¥é“è¿™ä¸ªç‚¹æ˜¯å“ªä¸ªç‚¹ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªå˜é‡è¦å­˜ç‚¹ã€‚
    heap.push({ 0, 1 });
    while(heap.size()){
        PII k = heap.top(); // å–ä¸åœ¨é›†åˆSä¸­è·ç¦»æœ€çŸ­çš„ç‚¹
        heap.pop();
        int ver = k.second, distance = k.first;

        if(st[ver]) continue;
        st[ver] = true;

        for(int i = h[ver]; i != -1; i = ne[i]){
            int j = e[i];
            if(dist[j] > distance + w[i]){
                dist[j] = distance + w[i];
                heap.push({ dist[j], j });
            }
        }
    }
    if(dist[n] == 0x3f3f3f3f) return -1;
    else return dist[n];
}

int main(){
    memset(h, -1, sizeof(h));
    scanf("%d%d", &n, &m);
    while (m--){
        int x, y, c;
        scanf("%d%d%d", &x, &y, &c);
        add(x, y, c);
    }
    cout << dijkstra() << endl;
    return 0;
}
```

{% endhideBlock %}

## Bellman-Ford

**ç®—æ³•æµç¨‹ï¼š**
å¾ªç¯næ¬¡(åé¢ä¼šè§£é‡Š)
æ¯æ¬¡å¾ªç¯éå†æ‰€æœ‰çš„è¾¹âœ¨
ä»¥ `a-(w)->b` ä¸ºä¾‹
æ›´æ–° `dis[b] = min(dis[b], dis[a] + w)`

ä¸ºä»€ä¹ˆè¦å¾ªç¯næ¬¡ï¼Œå› ä¸ºè´å°”æ›¼ç®—æ³•æ¯æ¬¡éå†æ‰€æœ‰è¾¹æ‰€æ±‚çš„çš„å…¶å®æ˜¯ç»è¿‡`i`æ¡è¾¹çš„æœ€çŸ­è·¯å¾„ï¼Œè€Œnä¸ªç‚¹çš„å›¾ä¸­ï¼Œä»»æ„ä¸¤ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯æœ€å¤šæœ‰`n-1`æ¡è¾¹,**å¦‚æœç¬¬næ¬¡ä»æœ‰æ›´æ–°ï¼Œåˆ™å¿…ç„¶å­˜åœ¨è´Ÿç¯**

![](https://picbed-1304952903.cos.ap-beijing.myqcloud.com/pic/blog202301121204382.gif)

âœ¨ï¼šä¹‹æ‰€ä»¥æ ‡æ˜Ÿï¼Œæ˜¯å› ä¸ºè¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼Œå¾ˆå¤šäººåˆå­¦(æ¯”å¦‚æˆ‘)è´å°”æ›¼ç®—æ³•çš„æ—¶å€™éƒ½ä¼šæŒ‰ç…§ä»¥å¾€çš„ä¹ æƒ¯é€‰æ‹©é‚»æ¥è¡¨ç­‰æ–¹æ³•å»ºå›¾ï¼Œä½†å®é™…ä¸Šï¼Œè´å°”æ›¼ç®—æ³•åªè¦æ±‚**éå†æ‰€æœ‰çš„è¾¹**ï¼Œæ‰€ä»¥åœ¨ç©ºé—´å…è®¸çš„æƒ…å†µä¸‹å¯ä»¥ç›´æ¥ä½¿ç”¨æœ€ç®€å•çš„æ•°æ®ç»“æ„ï¼š
```cpp
struct edge{
    int a, b, w;
}edges[m];
```

**ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSPFAéƒ½æ˜¯ä¼˜äºBellmançš„(å„ç§æ„ä¹‰ä¸Š)ï¼Œé™¤äº†ä¸€äº›ç‰¹æ®Šçš„é¢˜ç›®ï¼š**

{% btn 'https://www.acwing.com/activity/content/problem/content/922/',åŸé¢˜é“¾æ¥,far fa-hand-point-right,pink block %}

**æœ‰è¾¹æ•°é™åˆ¶çš„æœ€çŸ­è·¯**
ç»™å®šä¸€ä¸ª n ä¸ªç‚¹ m æ¡è¾¹çš„æœ‰å‘å›¾ï¼Œå›¾ä¸­å¯èƒ½å­˜åœ¨é‡è¾¹å’Œè‡ªç¯ï¼Œ è¾¹æƒå¯èƒ½ä¸ºè´Ÿæ•°ã€‚

è¯·ä½ æ±‚å‡ºä» 1 å·ç‚¹åˆ° n å·ç‚¹çš„æœ€å¤šç»è¿‡ k æ¡è¾¹çš„æœ€çŸ­è·ç¦»ï¼Œå¦‚æœæ— æ³•ä» 1 å·ç‚¹èµ°åˆ° n å·ç‚¹ï¼Œè¾“å‡º `impossible`ã€‚

æ³¨æ„ï¼šå›¾ä¸­å¯èƒ½ å­˜åœ¨è´Ÿæƒå›è·¯ ã€‚

**è¾“å…¥æ ¼å¼**
ç¬¬ä¸€è¡ŒåŒ…å«ä¸‰ä¸ªæ•´æ•° n,m,kã€‚

æ¥ä¸‹æ¥ m è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸‰ä¸ªæ•´æ•° x,y,zï¼Œè¡¨ç¤ºå­˜åœ¨ä¸€æ¡ä»ç‚¹ x åˆ°ç‚¹ y çš„æœ‰å‘è¾¹ï¼Œè¾¹é•¿ä¸º zã€‚

ç‚¹çš„ç¼–å·ä¸º 1âˆ¼nã€‚

**è¾“å‡ºæ ¼å¼**
è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºä» 1 å·ç‚¹åˆ° n å·ç‚¹çš„æœ€å¤šç»è¿‡ k æ¡è¾¹çš„æœ€çŸ­è·ç¦»ã€‚

å¦‚æœä¸å­˜åœ¨æ»¡è¶³æ¡ä»¶çš„è·¯å¾„ï¼Œåˆ™è¾“å‡º `impossible`ã€‚

**æ•°æ®èŒƒå›´**
`1â‰¤n`,`kâ‰¤500`,
`1â‰¤mâ‰¤10000`,
`1â‰¤x`,`yâ‰¤n`,
ä»»æ„è¾¹é•¿çš„ç»å¯¹å€¼ä¸è¶…è¿‡ `10000`ã€‚

**æ ·ä¾‹**
è¾“å…¥ï¼š
```
3 3 1
1 2 1
2 3 1
1 3 3
```
è¾“å‡ºï¼š
```
3
```

{% hideBlock code %}

```cpp
#include <bits/stdc++.h>
using namespace std;

const int N = 510, M = 1e4 + 10, inf = 0x3f3f3f3f;

int n, m, k;
int dis[N], backup[N];

struct Edge{
    int a, b, w;
}edges[M];

int Bellman_ford(){
    memset(dis, 0x3f, sizeof dis);
    dis[1] = 0;
    for(int i = 0; i < k ; i ++){
        memcpy(backup, dis, sizeof dis);
        //å¤‡ä»½æ˜¯ä¸ºäº†ä¿è¯æˆ‘ä»¬æ¯æ¬¡è¿›è¡Œæ¾å¼›æ“ä½œæ—¶ä½¿ç”¨çš„éƒ½æ˜¯ä¸Šä¸€æ¬¡çš„ç»“æœ
        //å› ä¸ºåœ¨éå†è¿‡ç¨‹ä¸­ï¼Œå…ˆè¢«éå†çš„èŠ‚ç‚¹çš„ dis å·²ç»å‘ç”Ÿå˜åŒ–äº†
        //ç”¨å˜åŒ–åçš„å€¼å†æ›´æ–°å…¶ä½™çš„ç‚¹ä¼šå¯¼è‡´è¾¹æ•°ä¸ç¬¦åˆè¦æ±‚
        for(int j = 0; j < m ; j ++){
            int a = edges[j].a, b = edges[j].b, w = edges[j].w;
            dis[b] = min(dis[b], backup[a] + w);
        }
    }
    if(dis[n] > inf / 2) return inf;
    return dis[n];
}

int main(){
    scanf("%d%d%d", &n, &m, &k);
    for(int i = 0; i < m; i ++){
        int a, b, w;
        scanf("%d%d%d", &a, &b, &w);
        edges[i] = {a, b, w};
    }

    int ans = Bellman_ford();

    if(ans == inf) puts("impossible");
    else printf("%d\n", ans);

    return 0;
}
```

{% endhideBlock %}

## SPFA

SPFAå°±æ˜¯å¯¹Bellmançš„ä¼˜åŒ–ï¼Œè€Œè¿™ç§ä¼˜åŒ–æ­£æ˜¯SPFAæ— æ³•å®ç°**æœ‰è¾¹æ•°é™åˆ¶çš„æœ€çŸ­è·¯**çš„åŸå› 

è§‚å¯ŸBellmanç®—æ³•ï¼Œæˆ‘ä»¬å‘ç°ï¼Œå¦‚æœaçš„è·ç¦»æ²¡æœ‰è¢«æ›´æ–°è¿‡ï¼Œé‚£ä¹ˆaçš„æ‰€æœ‰å‡ºè¾¹æŒ‡å‘çš„èŠ‚ç‚¹ä¹Ÿä¸å¯èƒ½è¢«aæ‰€æ›´æ–°ï¼Œæ‰€ä»¥å®é™…ä¸Šæˆ‘ä»¬å¹¶ä¸éœ€è¦çœŸçš„æ¯æ¬¡éƒ½**éå†æ‰€æœ‰çš„è¾¹**ï¼Œæˆ‘ä»¬åªéœ€è¦éå†**è¢«æ›´æ–°è¿‡çš„èŠ‚ç‚¹çš„æ‰€æœ‰å‡ºè¾¹**å³å¯
{% btn 'https://www.acwing.com/problem/content/853/',åŸé¢˜é“¾æ¥,far fa-hand-point-right,pink block %}

{% hideBlock code %}

```cpp
#include <bits/stdc++.h>
using namespace std;

const int N = 100010;

int n, m;
int h[N], w[N], e[N], ne[N], idx;
int dist[N];
bool st[N];

void add(int a, int b, int c){
    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++ ;
}

int spfa()
{
    memset(dist, 0x3f, sizeof dist);
    dist[1] = 0;

    queue<int> q;
    q.push(1);
    st[1] = true;

    while (q.size()){
        int t = q.front();
        q.pop();

        st[t] = false;

        for (int i = h[t]; i != -1; i = ne[i]){
            int j = e[i];
            if (dist[j] > dist[t] + w[i]){
                dist[j] = dist[t] + w[i];
                if (!st[j]){
                    q.push(j);
                    st[j] = true;
                }
            }
        }
    }

    return dist[n];
}

int main()
{
    scanf("%d%d", &n, &m);

    memset(h, -1, sizeof h);

    while (m -- ){
        int a, b, c;
        scanf("%d%d%d", &a, &b, &c);
        add(a, b, c);
    }

    int t = spfa();

    if (t == 0x3f3f3f3f) puts("impossible");
    else printf("%d\n", t);

    return 0;
}
```
æ€»æœ‰äººè¯´SPFAå®ƒæ­»äº†ï¼Œæˆ‘åªæƒ³è¯´â€¦â€¦
å¥½åƒæ˜¯æ­»äº†ï¼Œä½†æ²¡æ­»é€â€¦â€¦ğŸ¤”
{% endhideBlock %}

**SPFAæ±‚è´Ÿç¯**
åªéœ€è¦æ–°å¢`cnt[N]`æ•°ç»„ç”¨æ¥è®°å½•è¾¹æ•°å³å¯ï¼Œæ¯æ¬¡æ›´æ–°`cnt[b] = cnt[a] + 1`
é‚£å’Œå‰æ–‡è¯´çš„ä¸€æ ·ï¼Œæ ¹æ®æŠ½å±‰å®šç†ï¼Œåªè¦`cnt[x] >= n`è¯´æ˜å­˜åœ¨è´Ÿç¯
{% btn 'https://www.acwing.com/problem/content/854/',åŸé¢˜é“¾æ¥,far fa-hand-point-right,pink block %}

**é¢˜ç›®æè¿°**
ç»™å®šä¸€ä¸ª n ä¸ªç‚¹ m æ¡è¾¹çš„æœ‰å‘å›¾ï¼Œå›¾ä¸­å¯èƒ½å­˜åœ¨é‡è¾¹å’Œè‡ªç¯ï¼Œ è¾¹æƒå¯èƒ½ä¸ºè´Ÿæ•°ã€‚

è¯·ä½ åˆ¤æ–­å›¾ä¸­æ˜¯å¦å­˜åœ¨è´Ÿæƒå›è·¯ã€‚
**è¾“å…¥æ ¼å¼**
ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° n å’Œ mã€‚

æ¥ä¸‹æ¥ m è¡Œæ¯è¡ŒåŒ…å«ä¸‰ä¸ªæ•´æ•° x,y,zï¼Œè¡¨ç¤ºå­˜åœ¨ä¸€æ¡ä»ç‚¹ x åˆ°ç‚¹ y çš„æœ‰å‘è¾¹ï¼Œè¾¹é•¿ä¸º zã€‚

**è¾“å‡ºæ ¼å¼**

å¦‚æœå›¾ä¸­å­˜åœ¨è´Ÿæƒå›è·¯ï¼Œåˆ™è¾“å‡º Yesï¼Œå¦åˆ™è¾“å‡º Noã€‚

**æ•°æ®èŒƒå›´**
`1â‰¤nâ‰¤2000`,
`1â‰¤mâ‰¤10000`,
å›¾ä¸­æ¶‰åŠè¾¹é•¿ç»å¯¹å€¼å‡ä¸è¶…è¿‡ `10000`ã€‚


{% hideBlock code %}

```cpp
#include <bits/stdc++.h>
using namespace std;

const int N = 2010, M = 10010;

int n, m;
int h[N], w[M], e[M], ne[M], idx;
int dist[N], cnt[N];
bool st[N];

void add(int a, int b, int c){
    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++ ;
}

bool spfa(){
    queue<int> q;

    for (int i = 1; i <= n; i ++ ){
        st[i] = true;
        q.push(i);
    }

    while (q.size()){
        int t = q.front();
        q.pop();

        st[t] = false;

        for (int i = h[t]; i != -1; i = ne[i]){
            int j = e[i];
            if (dist[j] > dist[t] + w[i]){
                dist[j] = dist[t] + w[i];
                cnt[j] = cnt[t] + 1;

                if (cnt[j] >= n) return true;
                if (!st[j]){
                    q.push(j);
                    st[j] = true;
                }
            }
        }
    }
    return false;
}

int main(){
    scanf("%d%d", &n, &m);

    memset(h, -1, sizeof h);

    while (m -- ){
        int a, b, c;
        scanf("%d%d%d", &a, &b, &c);
        add(a, b, c);
    }

    if (spfa()) puts("Yes");
    else puts("No");

    return 0;
}
```

{% endhideBlock %}

## Floyd
ä½¿ç”¨é‚»æ¥çŸ©é˜µæ¥å­˜å‚¨ä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯
æ€è·¯â€¦â€¦ç›´æ¥çœ‹ä»£ç å°±æ‡‚äº†ï¼Œè‚¥è‚ æš´åŠ›

{% hideBlock code %}

```cpp
#include <bits/stdc++.h>
using namespace std;

const int N = 210, INF = 1e9;

int n, m, Q;
int d[N][N];

void floyd()
{
    for (int k = 1; k <= n; k ++ )
        for (int i = 1; i <= n; i ++ )
            for (int j = 1; j <= n; j ++ )
                d[i][j] = min(d[i][j], d[i][k] + d[k][j]);
}

int main()
{
    scanf("%d%d%d", &n, &m, &Q);

    for (int i = 1; i <= n; i ++ )
        for (int j = 1; j <= n; j ++ )
            if (i == j) d[i][j] = 0;
            else d[i][j] = INF;

    while (m -- ){
        int a, b, c;
        scanf("%d%d%d", &a, &b, &c);
        d[a][b] = min(d[a][b], c);
    }

    floyd();

    while (Q -- ){
        int a, b;
        scanf("%d%d", &a, &b);

        int t = d[a][b];
        if (t > INF / 2) puts("impossible");
        else printf("%d\n", t);
    }

    return 0;
}
```

{% endhideBlock %}


**æœ¬æ–‡ä¸­éƒ¨åˆ†ä»£ç æ¥è‡ªï¼šAcWingï¼Œä½œè€…ï¼šyxc**
[AcWing](https://www.acwing.com)