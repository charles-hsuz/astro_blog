---
title: å¿«é€Ÿå¹‚
categories: ç®—æ³•æ•™ç¨‹
slug: 20c47d09
date: 2023-01-05 17:46:59
cover: 'https://picbed-1304952903.cos.ap-beijing.myqcloud.com/pic/blog202302091658477.png'
---

# å¿«é€Ÿå¹‚çš„åŸç†å’Œå®ç°

## å¼•å…¥

å°æ˜æœ€æ–°è¿·ä¸Šäº†ä¿¡æ¯ç«èµ›â€¦â€¦
å¥½å§ï¼Œä¸æ‰¯æ·¡äº†ï¼Œåœ¨æˆ‘ä»¬åˆå­¦ç¼–ç¨‹æ—¶ä¸€å®šéƒ½åšè¿‡è¿™æ ·çš„é¢˜ç›®ï¼š
**è®¡ç®—açš„kæ¬¡æ–¹**
å½“æ—¶æˆ‘ä»¬æ˜¯æ€æ ·åšçš„å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œåªè¦å¾ªç¯`k`æ¬¡å°±å¯ä»¥äº†ï¼Œä½†æ˜¯è¿™æ ·çš„åšæ³•æ—¶é—´å¤æ‚åº¦æ˜¯`O(k)`çš„~~(è¿™ä¸ªOKçœŸçš„å¾ˆå¥½ç¬‘)~~
å¦‚æœè¦ç®—$\,\,a^{10^{10}}\,\,\,\,\,\,$éš¾é“è¦å¾ªç¯1e10æ¬¡å—ï¼Ÿæˆ‘ä»¬è¿˜èƒ½ä¸èƒ½æ›´å¿«å‘¢ï¼Ÿ

## åŸç†
 å…ˆè€ƒè™‘ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œå³ $k = 2^m,(m\in Z^+)$ çš„æƒ…å†µï¼Œæ¯”å¦‚ $\,a^{64}\,\,$ ï¼Ÿå¾ˆæ˜æ˜¾æˆ‘ä»¬å¯ä»¥å…ˆç®—å‡º$\,a^2\,$ï¼Œç„¶åç®—å‡º$\,\,a^4\,\,$ï¼Œâ€¦â€¦ï¼Œæœ€åå¾—åˆ°$\,\,a^{64}\,\,$:
$$\begin{split}
&a \times a = a^2\\
&a^2 \times a^2 = a^4\\
&a^4 \times a^4 = a^8\\
&a^8 \times a^8 = a^{16}\\
&a^{16} \times a^{16} = a^{32}\\
&a^{32} \times a^{32} = a^{64}\\
\end{split}$$

è¿™æ ·çš„è¯æˆ‘ä»¬åªè¦åš**6æ¬¡**ä¹˜æ³•ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º `O(log k)`

æ‰©å±•è¿™ç§æ–¹æ³•ï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦ç®— $\,\,a^{233}\,\,$ ,æˆ‘ä»¬ä¸éš¾å‘ç° $a^{233} = a^{1}\times a^{8}\times a^{32} \times a^{64} \times a ^{128}$ï¼Œä¹Ÿå³æˆ‘ä»¬åªéœ€è¦ç®—**0 + 3 + 5 + 6 + 7 + 4 = 25æ¬¡**ï¼Œç›¸æ¯”äºæœ´ç´ ç®—æ³•çš„**233æ¬¡**æ˜æ˜¾å‡å°‘

é‚£æˆ‘ä»¬å¦‚ä½•å°†å½¢å¦‚ $a^k$ çš„å½¢å¼è½¬åŒ–ä¸ºå¤šä¸ªæŒ‡æ•°ä¸º2çš„å¹‚ç›¸ä¹˜çš„å½¢å¼å‘¢ï¼Ÿ
è§‚å¯ŸæŒ‡æ•°çš„äºŒè¿›åˆ¶å½¢å¼ï¼Œä»¥`233`ä¸ºä¾‹
$(233)_{10} = (11101001)_2$
ä¹Ÿå³ $233 = 2^8 + 2^7 + 2^6 + 2^5 + 2^3 + 2^0$
è€Œè¿™æ˜¾ç„¶å¯ä»¥é€šè¿‡**ä½è¿ç®—**ç®€å•çš„å®ç°

## ä»£ç å®ç°
```cpp
int fast_pow(int a, int k){
    int ans = 1;
    while(k){
        if(k & 1 != 0){
            ans *= a;
        }
        a *= a;
        k >>= 1;
    }
    return ans;
}
```

å¯ä»¥é€šè¿‡è¡¨æ ¼ç†è§£ç¨‹åºçš„è¿ç®—è¿‡ç¨‹ï¼š

| å¾ªç¯æ¬¡æ•° | `b`        | `a`               | `ans & 1` | `ans`                                               |
| -------- | ---------- | ----------------- | --------- | --------------------------------------------------- |
| 1        | `11101001` | $\,\,a^1\,\,$     | `true`    | $\,\,a^1\,\,$                                       |
| 2        | `1110100`  | $\,\,a^2\,\,$     | `false`   | $\,\,a^1\,\,$                                       |
| 3        | `111010`   | $\,\,a^4\,\,$     | `false`   | $\,\,a^1\,\,$                                       |
| 4        | `11101`    | $\,\,a^8\,\,$     | `true`    | $\,\,a^{1+8}\,\,$                                   |
| 5        | `1110`     | $\,\,a^{16}\,\,$  | `false`   | $\,\,a^{1+8}\,\,$                                   |
| 6        | `111`      | $\,\,a^{32}\,\,$  | `true`    | $\,\,a^{1+8+32}\,\,\,\,\,\,$                        |
| 7        | `11`       | $\,\,a^{64}\,\,$  | `true`    | $\,\,a^{1+8+32+64}\,\,\,\,\,\,\,\,\,\,$             |
| 8        | `1`        | $\,\,a^{128}\,\,$ | `true`    | $\,\,a^{1+8+32+64+128}\,\,\,\,\,\,\,\,\,\,\,\,\,\,$ |
| 9        | `0`        | `N/A`             | `N/A`     | `N/A`                                               |

## 3?
*å…¶å®æ˜¯ä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜æˆ‘æ‰å†™çš„è¿™ç¯‡åšå®¢*
æ‰€ä»¥ï¼Œæˆ‘ä»¬èƒ½ä¸èƒ½æŠŠ2çš„å¹‚æ”¹æˆ3çš„ï¼Ÿ
ç­”æ¡ˆæ˜¯ï¼š**å¯ä»¥**
ä½†æ˜¯æ›´æ…¢ï¼Œé€šè¿‡ä¸Šé¢çš„æ¨å¯¼ï¼Œæˆ‘ä»¬åº”è¯¥èƒ½å‘ç°æˆ‘ä»¬ä¹‹æ‰€ä»¥èƒ½å¿«é€Ÿå°†æŒ‡æ•°`k`åˆ†è§£ä¸º2çš„å¹‚çš„å’Œçš„å½¢å¼ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬çš„ç”µè„‘æ˜¯**äºŒè¿›åˆ¶**å­˜å‚¨æ•°æ®çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½è¿ç®—å¾ˆæ–¹ä¾¿çš„å®ç°è¿™ç§åˆ†è§£ï¼Œå¦‚æœè¦åˆ©ç”¨3çš„å¹‚ï¼Œæˆ‘ä»¬é¦–å…ˆå¾—å¾—åˆ°æŒ‡æ•°çš„ä¸‰è¿›åˆ¶è¡¨ç¤ºï¼Œè¿˜å¾—å®šä¹‰ä¸‰è¿›åˆ¶çš„ä½è¿ç®—ï¼Œå¹¶ä¸”**è¿™äº›éƒ½æ˜¯é€šè¿‡äºŒè¿›åˆ¶çš„è¿ç®—å®ç°çš„**ï¼Œèˆæœ¬é€æœ«äº†å±äºæ˜¯ ğŸ¤”


## $a^n \mod m$

```cpp
using ll = long long;
ll fast_pow(ll a, ll b, ll mod){
    ll ans = 1;
    while(b){
        if(b & 1) ans = ans * a % mod;
        a = a * a % mod;
        b >>= 1;
    }
    return ans;
}
```
PS:è‹¥`mod`ä¸º64ä½æ•´æ•°ï¼Œåˆ™åº”å†™æˆå¦‚ä¸‹å½¢å¼ï¼š
```cpp
using ll = long long;
ll Product_mod(ll a, ll b, ll mod){
    ll sum = 0;
    while(b){
        if(b & 1) sum = (sum + a) % mod;
        a = (a + a) % c;
        b >>= 1;
    }
    return sum;
}
ll fast_pow(ll a, ll b, ll mod){
    ll ans = 1;
    while(b){
        if(b & 1) ans = Product_mod(ans, a, mod);
        a = Product_mod(a, a, mod);
        b >>= 1;
    }
    return ans;
}
```
ä¸»è¦æ˜¯ä¸ºäº†é˜²æ­¢`çˆ† long long`ï¼Œå…·ä½“åŸç†ä¸ºï¼š
$$\begin{split}
&a*233 \mod m\\
=\,\,&a*(1+8+32+64+128) \mod m\\
\Rightarrow \,&a * b\mod m = a * \sum_{i=0}^{k-1} b_i*2^i \mod m\\
\end{split}$$
å…¶ä¸­$b_i\,\,$è¡¨ç¤º`b`çš„äºŒè¿›åˆ¶ç¬¬`i`ä½

## çŸ©é˜µå¿«é€Ÿå¹‚
å…¶å®å°±æ˜¯æŠŠå¯¹åº”çš„æ•´å‹æ¢æˆçŸ©é˜µè€Œå·²ï¼Œéœ€è¦é‡è½½çŸ©é˜µç±»çš„ä¹˜æ³•ï¼Œ
ä¸ºäº†ç»Ÿä¸€ï¼Œå¯ä»¥å†™æˆæ¨¡æ¿
```cpp
using ll = long long;
template<typename T>
T fast_pow(T x, ll y){
    T ans = x;
    y --;
    while(y){
        if(y & 1){
            ans = ans * x;
            y >>= 1;
            x = x * x;
        }
        return ans;
    }
}
```
